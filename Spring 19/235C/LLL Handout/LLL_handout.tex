%% Please change the file name by replacing N with the apporpriate number
%% corresponding to the current homework and XX with your initials.
%% https://www.math.uci.edu/~gpatrick/jsOnline/hw1.html

\documentclass[11pt,letterpaper]{article}
\usepackage{amssymb,amsfonts,color,graphicx,amsmath,enumerate}
\usepackage{tikz} %This package offers the ability to draw pictures
\usepackage{amsthm,mathtools}

\usepackage{algorithm}
\usepackage[noend]{algpseudocode}

\newcommand{\naturals}{\mathbb{N}}
\newcommand{\integers}{\mathbb{Z}}
\newcommand{\complex}{\mathbb{C}}
\newcommand{\reals}{\mathbb{R}}
\newcommand{\exreals}{\overline{\mathbb{R}}}
\newcommand{\mcal}[1]{\mathcal{#1}}
\newcommand{\mable}{measurable}
\newcommand{\quats}{\mathbb{H}}
\newcommand{\rationals}{\mathbb{Q}}
\newcommand{\norm}{\trianglelefteq}
\newcommand{\Aut}{\text{Aut}}
\newcommand{\disk}{\mathbb{D}}
\newcommand{\halfplane}{\mathbb{H}}
\newcommand{\Lp}[2]{\left\|{#1}\right\|_{L^{#2}}}
\newcommand{\supp}[1]{\text{supp}({#1})}
\newcommand{\Hom}[2]{\text{Hom}_{{#1}}({#2})}
\newcommand{\tr}{\text{tr}}
\newcommand{\field}[1]{\mathbb{F}_{{#1}}}
\newcommand{\Gal}[1]{\text{Gal}\left({#1}\right)}
\newcommand{\esssup}{\text{ess sup }}
\newcommand{\essinf}{\text{ess inf }}
\newcommand{\affine}{\mathbb{A}}

\newenvironment{solution}
{\begin{proof}[Solution]}
{\end{proof}}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}{Lemma}[section]

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

\voffset=-3cm
\hoffset=-2.25cm
\textheight=24cm
\textwidth=17.25cm
\addtolength{\jot}{8pt}
\linespread{1.3}

\begin{document}
\noindent{\em Liam Hardiman\hfill{MATH 235C} }
% Please give relevant information
\begin{center}
{\bf \Large The LLL Algorithm} %Replace N with the appropriate number
\vspace{0.2cm}
\hrule
\end{center}
% history smeets in Nguyen and Valee
%LLL
%	Gram-Schmidt
%	
%Coppersmith
\section{Motivation}
The rows of the following matrices form bases for lattices in $\reals^3$:
\[
X = \begin{bmatrix*}[r]
	-168 & 602 & 58\\
	157 & -564 & -57\\
	594 & -2134 & -219\\
\end{bmatrix*}, \quad
Y = \begin{bmatrix*}[r]
	-6 & 6 & -4\\
	9 & 4 & 1\\
	-1 & 8 & 6\\
\end{bmatrix*}.
\]
In fact, one can check that the rows of $X$ and the rows of $Y$ actually span the \textit{same} lattice. Intuitively, the rows of $X$ seem to be a ``worse'' basis for $L$ than those of $Y$. Here we make precise the notion of a ``nice'' basis and introduce a polynomial time algorithm that transforms a ``bad'' basis into a ``good'' one. 

\section{Basis Reduction and the LLL Algorithm}
A basis is ``nice'' if the constituent vectors are short and orthogonal to one another. The Gram-Schmidt process transforms a given basis into an orthogonal basis, but when working in a lattice $L$, this Gram-Schmidt basis need not live in $L$.
\begin{definition}
	Let $x_1, \ldots, x_n$ be an ordered basis for a lattice $L$ in $\reals^n$, and let $x_1^*, \ldots, x_n^*$ be its Gram-Schmidt orthogonalization (GSO). Write $X = MX^*$ where $X$ (respectively $X^*$) is the matrix with $x_i$ (respectively $x_i^*$) as row $i$ and $M = (\mu_{ij})$ is the matrix of GSO coefficients. Let $\alpha$ be a real number with $\frac{1}{4}<\alpha<1$, called the reduction parameter (usually taken to be $\frac{3}{4}$). We say that the basis $x_1, \ldots, x_n$ is \textbf{$\alpha$-reduced} if it satisfies
	\begin{enumerate}
		\item $|\mu_{ij}|\leq \frac{1}{2}$ for all $1\leq j<i\leq n$,
		\item $|x_i^* + \mu_{i, i-1}x_{i-1}^*|^2 \geq \alpha|x_{i-1}^*|^2$ for $2\leq i\leq n$.
	\end{enumerate}
\end{definition}

\noindent Condition (1) says that the $i$-th basis vector is ``almost orthogonal'' to the span of the previous $i-1$ vectors. The vector $x_i^*+\mu_{i, i-1}x_{i-1}^*$ is the vector one obtains when swapping vectors $x_i$ and $x_{i-1}$ and then computing the $(i-1)$-st vector of the GSO. Condition (2) then says that this new GSO vector, while potentially shorter than $x_{i-1}^*$ isn't ``too much'' shorter.\\
\begin{algorithm}
\caption{The Original LLL Algorithm}
\textbf{Input: }A basis $x_1, \ldots, x_n$ of the lattice $L\subset \reals^n$ and a reduction parameter $\alpha\in (\frac{1}{4}, 1)$.\\
\textbf{Output: }An $\alpha$-reduced basis $y_1, \ldots, y_n$ of the lattice $L$.
\begin{algorithmic}[1]
	\Procedure{reduce}{$k, \ell$}
		\If{$|\mu_{k\ell}|>\frac{1}{2}$}
			\State Set $y_k \gets y_k - \lceil \mu_{k\ell}\rfloor y_\ell$.
			\For{$j = 1, 2, \ldots, \ell-1$}
				\State Set $\mu_{kj}\gets \mu_{kj}-\lceil\mu_{k\ell}\rfloor\mu_{\ell j}$.
			\EndFor
			\State Set $\mu_{k\ell}\gets \mu_{k\ell}-\lceil \mu_{k\ell}\rfloor$.
		\EndIf
	\EndProcedure

	\Procedure{exchange}{k}
		\State Set $z\gets y_{k-1}$, $y_{k-1}\gets y_k$, $y_k\gets z$.\Comment{exchange $y_{k-1}$ and $y_k$}
		\State Set $\nu\gets \mu_{k, k-1}$. Set $\delta \gets \gamma_k^* + \nu^2\gamma_{k-1}^*$.
		\State Set $\mu_{k, k-1}\gets \nu\gamma_{k-1}^*/\delta$. Set $\gamma_k^*\gets \gamma_k^*\gamma_{k-1}^*/\delta$. Set $\gamma_{k-1}^*\gets \delta$.
		\For{$j=1, 2, \ldots, k-2$}
			\State Set $t\gets \mu_{k-1, j}$, $\mu_{k-1, j}\gets \mu_{kj}$, $\mu_{kj}\gets t$.\Comment{exchange $\mu_{k-1, j}$ and $\mu_{kj}$}
		\EndFor
		\For{$i=k+1, \ldots, n$}
			\State Set $\xi \gets \mu_{ik}$. Set $\mu_{ik}\gets \mu_{k,k-1}-\nu\mu_{ik}$.
			\State Set $\mu_{i,k-1}\gets \mu_{k, k-1}\mu_{ik}+\xi$.
		\EndFor
	\EndProcedure

	\Procedure{Main}{}
		\For{$i=1, 2, \ldots, n$}
			\State Set $y_i\gets x_i$.
		\EndFor
		\For{$i=1, 2, \ldots, n$}
			\State Set $y_i^*\gets y_i$.
			\For{$j=1, 2, \ldots, i-1$}
				\State $\mu_{ij}\gets (y_i\cdot y_j^*)/\gamma_j^*$ and $y_i^*\gets y_i^*-\mu_{ij}y_j^*$.
			\EndFor
			\State Set $\gamma_i^*\gets y_i^*\cdot y_i^*$.
		\EndFor
		\State Set $k\gets 2$.
		\While{$k\leq n$}
			\State Call \Call{reduce}{$k, k-1$}.
			\If{$\gamma_k^* \geq (\alpha-\mu_{k,k-1}^2)\gamma_{k-1}^*$}
				\For{$\ell = k-2, \ldots, 2, 1$}
					\State Call \Call{reduce}{$k, \ell$}.
				\EndFor
				\State Set $k\gets k+1$.
			\Else
				\State Call \Call{exchange}{$k$}.
				\If{$k>2$}
					\State Set $k\gets k-1$.
				\EndIf
			\EndIf
		\EndWhile
	\EndProcedure
% \If {$i\geq maxval$}
%     \State $i\gets 0$
% \Else
%     \If {$i+k\leq maxval$}
%         \State $i\gets i+k$
%     \EndIf
% \EndIf
\end{algorithmic}
\end{algorithm}
% \begin{lemma}
% 	Let $x_1, \ldots, x_n$ be a basis for the lattice $L\subset \reals^n$ and let $y_1, \ldots, y_n$ be a collection of $n$ vectors in $L$. Let $X$ and $Y$ be the $n\times n$ matrices with rows $x_1, \ldots, x_n$ and $y_1, \ldots, y_n$, respectively. Then $y_1, \ldots, y_n$ is a basis for $L$ if and only if there is an $n\times n$ matrix $C$ with integer entries and $\det(C) = \pm 1$ such that $Y = CX$.
% \end{lemma}



\end{document}